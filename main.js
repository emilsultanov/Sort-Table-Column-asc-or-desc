
const mainData = [
   {
      "no": 1,
      "fullName": "Farid",
      "position": "CMD",
      "age": 29,
      "match": 12,
      "goal": 12,
      "assist": 4,
      "yellowCard": 3,
      "doubleYellowCard": 0,
      "redCard": 2
   },
   {
      "no": 2,
      "fullName": "Emil",
      "position": "GK",
      "match": 34,
      "goal": 1,
      "assist": 17,
      "yellowCard": 8,
      "doubleYellowCard": 3,
      "redCard": 5
   },
   {
      "no": 3,
      "fullName": "Tom",
      "position": "ST",
      "match": 5,
      "goal": 1,
      "assist": 2,
      "yellowCard": 5,
      "doubleYellowCard": 1,
      "redCard": 4
   },
   {
      "no": 4,
      "fullName": "Jerry",
      "position": "DL",
      "match": 2,
      "goal": 0,
      "assist": 1,
      "yellowCard": 3,
      "doubleYellowCard": 4,
      "redCard": 5
   },
   {
      "no": 5,
      "fullName": "Alixandro",
      "position": "ST",
      "match": 15,
      "goal": 13,
      "assist": 82,
      "yellowCard": 15,
      "doubleYellowCard": 31,
      "redCard": 64
   },
   {
      "no": 6,
      "fullName": "Şəmi",
      "position": "ST",
      "match": 85,
      "goal": 11,
      "assist": 28,
      "yellowCard": 59,
      "doubleYellowCard": 15,
      "redCard": 47
   },
   {
      "no": 7,
      "fullName": "Şöşü",
      "position": "ST",
      "match": 74,
      "goal": 42,
      "assist": 14,
      "yellowCard": 32,
      "doubleYellowCard": 33,
      "redCard": 8
   },
   {
      "no": 8,
      "fullName": "Fəlakət",
      "position": "ST",
      "match": 3,
      "goal": 1,
      "assist": 2,
      "yellowCard": 5,
      "doubleYellowCard": 1,
      "redCard": 4
   },
   {
      "no": 9,
      "fullName": "Şirin",
      "position": "ST",
      "match": 8,
      "goal": 1,
      "assist": 2,
      "yellowCard": 5,
      "doubleYellowCard": 1,
      "redCard": 4
   },
   {
      "no": 10,
      "fullName": "Ağsaqqal",
      "position": "ST",
      "match": 24,
      "goal": 1,
      "assist": 2,
      "yellowCard": 5,
      "doubleYellowCard": 1,
      "redCard": 4
   },
   {
      "no": 11,
      "fullName": "Əzəmət",
      "position": "ST",
      "match": 5,
      "goal": 1,
      "assist": 2,
      "yellowCard": 5,
      "doubleYellowCard": 1,
      "redCard": 4
   },
   {
      "no": 12,
      "fullName": "kdfskdnkj",
      "position": "mt",
      "match": 23,
      "goal": 89,
      "assist": 32,
      "yellowCard": 65,
      "doubleYellowCard": 41,
      "redCard": 84
   },
   {
      "no": 13,
      "fullName": "fifo",
      "position": "hhh",
      "match": 5,
      "goal": 1,
      "assist": 2,
      "yellowCard": 5,
      "doubleYellowCard": 1,
      "redCard": 4
   },
   {
      "no": 14,
      "fullName": "fezil",
      "position": "YT",
      "match": 11,
      "goal": 23,
      "assist": 72,
      "yellowCard": 51,
      "doubleYellowCard": 15,
      "redCard": 6
   },
   {
      "no": 15,
      "fullName": "Farid",
      "position": "CMD",
      "age": 29,
      "match": 12,
      "goal": 12,
      "assist": 4,
      "yellowCard": 3,
      "doubleYellowCard": 0,
      "redCard": 2
   },
   {
      "no": 16,
      "fullName": "Emil",
      "position": "GK",
      "match": 34,
      "goal": 1,
      "assist": 17,
      "yellowCard": 8,
      "doubleYellowCard": 3,
      "redCard": 5
   },
   {
      "no": 17,
      "fullName": "Tom",
      "position": "ST",
      "match": 5,
      "goal": 1,
      "assist": 2,
      "yellowCard": 5,
      "doubleYellowCard": 1,
      "redCard": 4
   },
   {
      "no": 18,
      "fullName": "Jerry",
      "position": "DL",
      "match": 2,
      "goal": 0,
      "assist": 1,
      "yellowCard": 3,
      "doubleYellowCard": 4,
      "redCard": 5
   },
   {
      "no": 19,
      "fullName": "Alixandro",
      "position": "ST",
      "match": 15,
      "goal": 13,
      "assist": 82,
      "yellowCard": 15,
      "doubleYellowCard": 31,
      "redCard": 64
   },
   {
      "no": 20,
      "fullName": "Şəmi",
      "position": "ST",
      "match": 85,
      "goal": 11,
      "assist": 28,
      "yellowCard": 59,
      "doubleYellowCard": 15,
      "redCard": 47
   },
   {
      "no": 21,
      "fullName": "Şöşü",
      "position": "ST",
      "match": 74,
      "goal": 42,
      "assist": 14,
      "yellowCard": 32,
      "doubleYellowCard": 33,
      "redCard": 8
   },
   {
      "no": 22,
      "fullName": "Fəlakət",
      "position": "ST",
      "match": 8,
      "goal": 1,
      "assist": 2,
      "yellowCard": 5,
      "doubleYellowCard": 1,
      "redCard": 4
   },
   {
      "no": 23,
      "fullName": "Şirin",
      "position": "ST",
      "match": 5,
      "goal": 1,
      "assist": 2,
      "yellowCard": 5,
      "doubleYellowCard": 1,
      "redCard": 4
   },
   {
      "no": 24,
      "fullName": "Ağsaqqal",
      "position": "ST",
      "match": 11,
      "goal": 1,
      "assist": 2,
      "yellowCard": 5,
      "doubleYellowCard": 1,
      "redCard": 4
   },
   {
      "no": 25,
      "fullName": "Əzəmət",
      "position": "ST",
      "match": 9,
      "goal": 1,
      "assist": 2,
      "yellowCard": 5,
      "doubleYellowCard": 1,
      "redCard": 4
   },
   {
      "no": 26,
      "fullName": "kdfskdnkj",
      "position": "mt",
      "match": 23,
      "goal": 89,
      "assist": 32,
      "yellowCard": 65,
      "doubleYellowCard": 41,
      "redCard": 84
   },
   {
      "no": 27,
      "fullName": "fifo",
      "position": "hhh",
      "match": 5,
      "goal": 1,
      "assist": 2,
      "yellowCard": 5,
      "doubleYellowCard": 1,
      "redCard": 4
   },
   {
      "no": 28,
      "fullName": "fezil",
      "position": "YT",
      "match": 11,
      "goal": 23,
      "assist": 72,
      "yellowCard": 51,
      "doubleYellowCard": 15,
      "redCard": 6
   },
   {
      "no": 29,
      "fullName": "Ağsaqqal",
      "position": "ST",
      "match": 5,
      "goal": 1,
      "assist": 2,
      "yellowCard": 5,
      "doubleYellowCard": 1,
      "redCard": 4
   },
   {
      "no": 30,
      "fullName": "Əzəmət",
      "position": "ST",
      "match": 5,
      "goal": 1,
      "assist": 2,
      "yellowCard": 5,
      "doubleYellowCard": 1,
      "redCard": 4
   },
];


let sliceData, filterTitle;
let filterType = 'mixed';
let rowsPerPage = 5, pagesPerPagination = 3;
let pagination__list = document.querySelector('.pagination__list');
let pagination_items_count = Math.ceil(mainData.length / rowsPerPage);



// Create dnyamic pagination items
for (let i = 0; i < pagination_items_count; i++) {

   let pagination_item = document.createElement('li');
   let node = document.createTextNode(i + 1);

   pagination_item.appendChild(node);
   pagination_item.classList.add('pagination__item');
   pagination_item.addEventListener('click', pagination__item_handler);
   pagination__list.appendChild(pagination_item);

};
pagination__list.children[0].classList.add('pagination__item_isActive');



// Get index of clicked pagination item
function pagination__item_handler(e) {
   let clickedIndex = Array.from(document.querySelectorAll('.pagination__item')).indexOf(this);
   Array.from(pagination__list.children).forEach(child => child.classList.remove('pagination__item_isActive'));
   this.classList.add('pagination__item_isActive');
   divideData(mainData, rowsPerPage, clickedIndex);
}



// Slice data for rows-per-page
function divideData(items, rows_per_page, page) {
   let start = rows_per_page * page;
   let end = start + rows_per_page;
   let partOfData = items.slice(start, end);
   sliceData = partOfData;


   if (filterType === 'mixed') {
      loadTableContent(sliceData);
   }
   else if (filterType === 'desc') {
      let sorted__array = sort__array(sliceData, filterTitle, 'asc');
      loadTableContent(sorted__array);
   }
   else if (filterType === 'asc') {
      let sorted__array = sort__array(sliceData, filterTitle, 'desc');
      loadTableContent(sorted__array);
   }

}
divideData(mainData, rowsPerPage, 0);






// Update Table Content
function loadTableContent(filteredData) {
   let table = filteredData.map(item => {
      return (
         `<tr>
            <td>${item.no}</td>
            <td>${item.fullName}</td>
            <td>${item.position}</td>
            <td>${item.match}</td>
            <td>${item.goal}</td>
            <td>${item.assist}</td>
            <td>${item.yellowCard}</td>
            <td>${item.doubleYellowCard}</td>
            <td>${item.redCard}</td>
          </tr>`
      );
   });
   document.querySelector('.bodyOfSortableTable').innerHTML = table.join('');
};



// Select Pagination Buttons and add EventListener
let pagination_btns = Array.from(document.querySelectorAll('[data-pagination-direct]'));
pagination_btns.forEach(btn => btn.addEventListener('click', pagination_btn_handler));


//  Pagination Buttons EventListener
function pagination_btn_handler() {

   let paginationDirect = this.dataset.paginationDirect;

   if (paginationDirect === 'prev') {
      for (let i = 0; i < pagination__list.children.length; i++) {
         if (pagination__list.children[i].classList.contains('pagination__item_isActive') && pagination__list.children[i].previousElementSibling) {
            pagination__list.children[i].classList.remove('pagination__item_isActive');
            pagination__list.children[i].previousElementSibling.classList.add('pagination__item_isActive');
            divideData(mainData, rowsPerPage, i - 1);
            break;
         }
      }
   }
   else {
      for (let i = 0; i < pagination__list.children.length; i++) {
         if (pagination__list.children[i].classList.contains('pagination__item_isActive') && pagination__list.children[i].nextElementSibling) {
            pagination__list.children[i].classList.remove('pagination__item_isActive');
            pagination__list.children[i].nextElementSibling.classList.add('pagination__item_isActive');
            divideData(mainData, rowsPerPage, i + 1);
            break;
         }
      }
   }

};



// Select Table Title and Add EventListener
let filterTitles = document.querySelectorAll('[data-filter-value]');
filterTitles.forEach(title => title.addEventListener('click', filterColumn));


// FilterTable Column
function filterColumn(e) {

   let lastActiveElements = document.querySelectorAll('th[data-filter-value]');
   lastActiveElements.forEach(element => element.classList.remove('activeTitle'));
   e.target.classList.add('activeTitle');

   filterTitle = e.target.dataset.filterValue;
   let sort__data = sort__array(sliceData, filterTitle, filterType);

   loadTableContent(sort__data);
};


// Sort Table Content
function sort__array(arr, filter, type) {

   if (type === 'mixed' || type === 'asc') {
      console.log(type)
      for (let i = 0; i < arr.length; i++) {
         for (let j = arr.length - 1; j > i; j--) {
            if (arr[i][filter] > arr[j][filter]) {
               let max = arr[i];
               arr[i] = arr[j];
               arr[j] = max;
            }
         }
      }
      filterType = 'desc';
      return arr;
   }
   else if (type === 'desc') {
      console.log(type)
      for (let i = 0; i < arr.length; i++) {
         for (let j = arr.length - 1; j > i; j--) {
            if (arr[i][filter] < arr[j][filter]) {
               let min = arr[j];
               arr[j] = arr[i];
               arr[i] = min;
            }
         }
      }
      filterType = 'asc';
      return arr;
   }
};














